{
  "id": "vite-testing",
  "title": "ğŸ§ª Vite + Vitest æµ‹è¯•ç¯å¢ƒæ­å»º",
  "description": "æµ‹è¯•æ˜¯ä¿è¯ä»£ç è´¨é‡çš„é‡è¦æ‰‹æ®µï¼è¿™ä¸€å…³å°†æ•™ä½ åœ¨Viteé¡¹ç›®ä¸­é…ç½®Vitestæµ‹è¯•æ¡†æ¶ï¼ŒåŒ…æ‹¬å•å…ƒæµ‹è¯•ã€ç»„ä»¶æµ‹è¯•å’Œè¦†ç›–ç‡æŠ¥å‘Šã€‚Vitestæ˜¯ä¸“ä¸ºViteè®¾è®¡çš„æµ‹è¯•æ¡†æ¶ï¼Œé…ç½®ç®€å•ã€è¿è¡Œå¿«é€Ÿï¼Œæ˜¯ç°ä»£å‰ç«¯é¡¹ç›®çš„æœ€ä½³é€‰æ‹©ã€‚",
  "difficulty": "ä¸­çº§",
  "estimatedTime": "30åˆ†é’Ÿ",
  "category": "vite",
  "prerequisites": ["vite-basic"],
  "scenario": "ä½ çš„Reacté¡¹ç›®å·²ç»å¼€å‘äº†ä¸€æ®µæ—¶é—´ï¼Œä½†è¿˜æ²¡æœ‰æµ‹è¯•è¦†ç›–ã€‚ä¸ºäº†ä¿è¯ä»£ç è´¨é‡å’Œé‡æ„å®‰å…¨ï¼Œä½ éœ€è¦æ­å»ºå®Œæ•´çš„æµ‹è¯•ç¯å¢ƒã€‚åŒ…æ‹¬å•å…ƒæµ‹è¯•ã€ç»„ä»¶æµ‹è¯•ï¼Œä»¥åŠç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Šæ¥äº†è§£æµ‹è¯•è¦†ç›–æƒ…å†µã€‚",
  "learningObjectives": [
    "ğŸ”§ é…ç½®Vitestæµ‹è¯•æ¡†æ¶ï¼Œäº«å—ä¸Viteçš„å®Œç¾é›†æˆ",
    "ğŸ“Š è®¾ç½®æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Šï¼Œé‡åŒ–æµ‹è¯•è´¨é‡",
    "ğŸ§© é…ç½®Reactç»„ä»¶æµ‹è¯•ç¯å¢ƒï¼ŒåŒ…æ‹¬jsdomå’Œtesting-library",
    "âš¡ ä¼˜åŒ–æµ‹è¯•é…ç½®ï¼Œæå‡æµ‹è¯•è¿è¡Œæ•ˆç‡"
  ],
  "tasks": [
    {
      "id": "basic-vitest-config",
      "title": "ğŸ—ï¸ ç¬¬ä¸€æ­¥ï¼šåŸºç¡€Vitesté…ç½®",
      "description": "åœ¨vite.config.jsä¸­æ·»åŠ Vitestçš„åŸºæœ¬é…ç½®ã€‚Vitestå¯ä»¥å¤ç”¨Viteçš„é…ç½®ï¼Œè¿™æ˜¯å®ƒç›¸æ¯”å…¶ä»–æµ‹è¯•æ¡†æ¶çš„ä¸€å¤§ä¼˜åŠ¿ã€‚",
      "detailedInstructions": [
        "åœ¨vite.config.jsä¸­æ·»åŠ testé…ç½®å¯¹è±¡",
        "è®¾ç½®globals: trueï¼ˆå…¨å±€ä½¿ç”¨describeã€itç­‰å‡½æ•°ï¼Œæ— éœ€å¯¼å…¥ï¼‰",
        "è®¾ç½®environment: 'jsdom'ï¼ˆæ¨¡æ‹Ÿæµè§ˆå™¨ç¯å¢ƒï¼Œç”¨äºç»„ä»¶æµ‹è¯•ï¼‰",
        "é…ç½®setupFilesæŒ‡å‘æµ‹è¯•è®¾ç½®æ–‡ä»¶",
        "è®¾ç½®includeåŒ¹é…æµ‹è¯•æ–‡ä»¶æ¨¡å¼"
      ],
      "validation": {
        "type": "file-content",
        "file": "vite.config.js",
        "contains": "test:"
      }
    },
    {
      "id": "coverage-configuration",
      "title": "ğŸ“Š ç¬¬äºŒæ­¥ï¼šé…ç½®è¦†ç›–ç‡æŠ¥å‘Š",
      "description": "é…ç½®æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Šï¼Œè®©ä½ æ¸…æ¥šåœ°äº†è§£å“ªäº›ä»£ç è¢«æµ‹è¯•è¦†ç›–äº†ï¼Œå“ªäº›è¿˜éœ€è¦è¡¥å……æµ‹è¯•ã€‚è¿™å¯¹äºä¿è¯ä»£ç è´¨é‡éå¸¸é‡è¦ã€‚",
      "detailedInstructions": [
        "åœ¨testé…ç½®ä¸­æ·»åŠ coverageå¯¹è±¡",
        "è®¾ç½®provider: 'v8'ï¼ˆä½¿ç”¨V8å¼•æ“çš„è¦†ç›–ç‡æ”¶é›†ï¼‰",
        "é…ç½®reporter: ['text', 'json', 'html']ï¼ˆå¤šç§æ ¼å¼çš„æŠ¥å‘Šï¼‰",
        "è®¾ç½®excludeæ•°ç»„ï¼Œæ’é™¤ä¸éœ€è¦æµ‹è¯•çš„æ–‡ä»¶ï¼ˆå¦‚node_modulesã€é…ç½®æ–‡ä»¶ç­‰ï¼‰",
        "è¿™æ ·è¿è¡Œnpm run test:coverageå°±èƒ½ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š"
      ],
      "validation": {
        "type": "file-content",
        "file": "vite.config.js",
        "contains": "coverage"
      }
    },
    {
      "id": "optimize-test-config",
      "title": "âš¡ ç¬¬ä¸‰æ­¥ï¼šä¼˜åŒ–æµ‹è¯•é…ç½®",
      "description": "è¿›ä¸€æ­¥ä¼˜åŒ–æµ‹è¯•é…ç½®ï¼ŒåŒ…æ‹¬å¹¶å‘æ‰§è¡Œã€è¶…æ—¶è®¾ç½®ç­‰ï¼Œè®©æµ‹è¯•è¿è¡Œæ›´å¿«æ›´ç¨³å®šã€‚",
      "detailedInstructions": [
        "è®¾ç½®threads: trueï¼ˆå¯ç”¨å¤šçº¿ç¨‹å¹¶å‘æµ‹è¯•ï¼‰",
        "é…ç½®testTimeout: 10000ï¼ˆè®¾ç½®æµ‹è¯•è¶…æ—¶æ—¶é—´ï¼‰",
        "è®¾ç½®watch: falseï¼ˆé»˜è®¤ä¸å¯ç”¨ç›‘å¬æ¨¡å¼ï¼‰",
        "åœ¨buildé…ç½®ä¸­æ·»åŠ sourcemap: trueï¼ˆä¾¿äºè°ƒè¯•æµ‹è¯•ï¼‰",
        "é…ç½®rollupOptions.output.manualChunksä¼˜åŒ–æ„å»º"
      ],
      "validation": {
        "type": "file-content",
        "file": "vite.config.js",
        "contains": "threads"
      }
    }
  ],
  "progressiveHints": [
    {
      "attempt": 1,
      "hint": "ğŸ§ª **ç¬¬ä¸€æ¬¡æç¤º**ï¼šVitesté…ç½®åœ¨vite.config.jsçš„testå­—æ®µä¸­ã€‚ä»åŸºç¡€é…ç½®å¼€å§‹ï¼š`test: { globals: true, environment: 'jsdom' }`"
    },
    {
      "attempt": 2,
      "hint": "ğŸ“ˆ **ç¬¬äºŒæ¬¡æç¤º**ï¼šè¦†ç›–ç‡é…ç½®æ˜¯test.coverageå¯¹è±¡ã€‚ä½ éœ€è¦è®¾ç½®ï¼š\n- provider: 'v8'\n- reporter: ['text', 'json', 'html']\n- exclude: ['node_modules/', 'src/test/', '**/*.config.js']"
    },
    {
      "attempt": 3,
      "hint": "ğŸš€ **ç¬¬ä¸‰æ¬¡æç¤º**ï¼šå®Œæ•´çš„æµ‹è¯•é…ç½®åŒ…æ‹¬ï¼š\n1. åŸºç¡€é…ç½®ï¼šglobals, environment, setupFiles\n2. è¦†ç›–ç‡ï¼šcoverageå¯¹è±¡é…ç½®\n3. æ€§èƒ½ä¼˜åŒ–ï¼šthreads, testTimeout\n4. æ–‡ä»¶åŒ¹é…ï¼šincludeæ¨¡å¼\n\nåˆ«å¿˜äº†åœ¨é¡¶éƒ¨å¯¼å…¥ï¼š`import { defineConfig } from 'vite'`"
    }
  ],
  "resources": [
    {
      "title": "Vitest å®˜æ–¹æ–‡æ¡£",
      "url": "https://vitest.dev/"
    }
  ],
  "solution": {
    "vite.config.js": "import { defineConfig } from 'vite'\nimport react from '@vitejs/plugin-react'\n\nexport default defineConfig({\n  plugins: [react()],\n  \n  // æµ‹è¯•é…ç½®\n  test: {\n    globals: true,\n    environment: 'jsdom',\n    setupFiles: './src/test/setup.js',\n    \n    // è¦†ç›–ç‡é…ç½®\n    coverage: {\n      provider: 'v8',\n      reporter: ['text', 'json', 'html'],\n      exclude: [\n        'node_modules/',\n        'src/test/',\n        '**/*.d.ts',\n        '**/*.config.js'\n      ]\n    },\n    \n    // æµ‹è¯•æ–‡ä»¶åŒ¹é…æ¨¡å¼\n    include: ['src/**/*.{test,spec}.{js,jsx,ts,tsx}'],\n    \n    // ç›‘å¬æ¨¡å¼é…ç½®\n    watch: false,\n    \n    // å¹¶å‘æµ‹è¯•\n    threads: true,\n    \n    // æµ‹è¯•è¶…æ—¶\n    testTimeout: 10000,\n  },\n  \n  // æ„å»ºé…ç½®\n  build: {\n    sourcemap: true,\n    rollupOptions: {\n      output: {\n        manualChunks: {\n          vendor: ['react', 'react-dom'],\n          testing: ['@testing-library/react', '@testing-library/jest-dom']\n        }\n      }\n    }\n  },\n  \n  // å¼€å‘æœåŠ¡å™¨é…ç½®\n  server: {\n    port: 3000,\n    open: true\n  }\n})",
    "src/test/setup.js": "import '@testing-library/jest-dom'\n\n// å…¨å±€æµ‹è¯•è®¾ç½®\nglobal.ResizeObserver = class ResizeObserver {\n  constructor(cb) {\n    this.cb = cb;\n  }\n  observe() {\n    this.cb([{ borderBoxSize: { inlineSize: 0, blockSize: 0 } }], this);\n  }\n  unobserve() {}\n  disconnect() {}\n};\n\n// Mock window.matchMedia\nObject.defineProperty(window, 'matchMedia', {\n  writable: true,\n  value: jest.fn().mockImplementation(query => ({\n    matches: false,\n    media: query,\n    onchange: null,\n    addListener: jest.fn(),\n    removeListener: jest.fn(),\n    addEventListener: jest.fn(),\n    removeEventListener: jest.fn(),\n    dispatchEvent: jest.fn(),\n  })),\n});"
  }
}