{
  "id": "webpack-module-federation",
  "title": "ğŸ—ï¸ Webpack æ¨¡å—è”é‚¦ - æ„å»ºçœŸæ­£çš„å¾®å‰ç«¯æ¶æ„",
  "description": "æ¨¡å—è”é‚¦æ˜¯Webpack 5çš„é©å‘½æ€§åŠŸèƒ½ï¼Œè®©ä½ å¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€åŠ è½½å…¶ä»–åº”ç”¨çš„æ¨¡å—ã€‚æƒ³è±¡ä¸€ä¸‹ï¼ŒHeaderç»„ä»¶ç”±Aå›¢é˜Ÿå¼€å‘ï¼ŒSidebarç”±Bå›¢é˜Ÿç»´æŠ¤ï¼Œå®ƒä»¬å¯ä»¥ç‹¬ç«‹éƒ¨ç½²ï¼Œä½†åœ¨ä¸»åº”ç”¨ä¸­æ— ç¼é›†æˆã€‚è¿™å°±æ˜¯å¾®å‰ç«¯çš„é­…åŠ›ï¼",
  "difficulty": "é«˜çº§",
  "estimatedTime": "50åˆ†é’Ÿ",
  "category": "webpack",
  "scenario": "ä½ çš„å…¬å¸æœ‰å¤šä¸ªå‰ç«¯å›¢é˜Ÿï¼Œæ¯ä¸ªå›¢é˜Ÿè´Ÿè´£ä¸åŒçš„ä¸šåŠ¡æ¨¡å—ã€‚ç°åœ¨éœ€è¦å°†è¿™äº›æ¨¡å—æ•´åˆåˆ°ä¸€ä¸ªä¸»åº”ç”¨ä¸­ï¼Œä½†åˆè¦ä¿æŒå„å›¢é˜Ÿçš„ç‹¬ç«‹å¼€å‘å’Œéƒ¨ç½²èƒ½åŠ›ã€‚ä½ éœ€è¦ä½¿ç”¨æ¨¡å—è”é‚¦æ¥å®ç°è¿™ä¸ªå¾®å‰ç«¯æ¶æ„ã€‚",
  "learningObjectives": [
    "ğŸ—ï¸ ç†è§£å¾®å‰ç«¯æ¶æ„å’Œæ¨¡å—è”é‚¦çš„æ ¸å¿ƒä»·å€¼",
    "ğŸ”— é…ç½®Hoståº”ç”¨æ¥æ¶ˆè´¹è¿œç¨‹æ¨¡å—",
    "ğŸ“¡ é…ç½®Remoteåº”ç”¨æ¥æš´éœ²å¯å…±äº«çš„æ¨¡å—",
    "ğŸ¤ å®ç°ä¾èµ–å…±äº«ï¼Œé¿å…é‡å¤åŠ è½½"
  ],
  "tasks": [
    {
      "id": "setup-shell-app",
      "title": "ğŸ  ä»»åŠ¡1ï¼šé…ç½®ä¸»åº”ç”¨(Shell)",
      "description": "åˆ›å»ºä¸»åº”ç”¨ï¼Œå®ƒå°†ä½œä¸ºHostæ¥æ¶ˆè´¹å…¶ä»–å¾®åº”ç”¨çš„æ¨¡å—ã€‚ä¸»åº”ç”¨è´Ÿè´£æ•´ä½“å¸ƒå±€å’Œè·¯ç”±ç®¡ç†ã€‚",
      "specificSteps": [
        {
          "step": 1,
          "action": "åœ¨shell/webpack.config.jsä¸­é…ç½®ModuleFederationPlugin",
          "code": "const ModuleFederationPlugin = require('@module-federation/webpack');\n\nmodule.exports = {\n  mode: 'development',\n  entry: './src/index.js',\n  devServer: {\n    port: 3000\n  },\n  plugins: [\n    new ModuleFederationPlugin({\n      name: 'shell',\n      remotes: {\n        header: 'header@http://localhost:3001/remoteEntry.js',\n        sidebar: 'sidebar@http://localhost:3002/remoteEntry.js'\n      },\n      shared: {\n        react: { singleton: true },\n        'react-dom': { singleton: true }\n      }\n    })\n  ]\n};",
          "explanation": "Shellåº”ç”¨é€šè¿‡remotesé…ç½®æ¥æ¶ˆè´¹è¿œç¨‹æ¨¡å—"
        }
      ],
      "shellAppFeatures": {
        "name": "å½“å‰åº”ç”¨çš„å”¯ä¸€æ ‡è¯†ç¬¦",
        "remotes": "é…ç½®è¦æ¶ˆè´¹çš„è¿œç¨‹åº”ç”¨å’Œå®ƒä»¬çš„åœ°å€",
        "shared": "é…ç½®å…±äº«çš„ä¾èµ–ï¼Œé¿å…é‡å¤åŠ è½½",
        "singleton": "ç¡®ä¿åªæœ‰ä¸€ä¸ªReactå®ä¾‹"
      },
      "expectedResult": "ä¸»åº”ç”¨å¯ä»¥åŠ¨æ€åŠ è½½è¿œç¨‹çš„Headerå’ŒSidebarç»„ä»¶",
      "validation": {
        "type": "file-content",
        "file": "shell/webpack.config.js",
        "contains": "ModuleFederationPlugin"
      }
    },
    {
      "id": "setup-header-remote",
      "title": "ğŸ“¡ ä»»åŠ¡2ï¼šé…ç½®Headerè¿œç¨‹åº”ç”¨",
      "description": "åˆ›å»ºHeaderå¾®åº”ç”¨ï¼Œå®ƒå°†æš´éœ²Headerç»„ä»¶ä¾›ä¸»åº”ç”¨ä½¿ç”¨ã€‚è¿™ä¸ªåº”ç”¨å¯ä»¥ç‹¬ç«‹å¼€å‘å’Œéƒ¨ç½²ã€‚",
      "specificSteps": [
        {
          "step": 1,
          "action": "åœ¨header/webpack.config.jsä¸­é…ç½®æš´éœ²æ¨¡å—",
          "code": "const ModuleFederationPlugin = require('@module-federation/webpack');\n\nmodule.exports = {\n  mode: 'development',\n  entry: './src/index.js',\n  devServer: {\n    port: 3001\n  },\n  plugins: [\n    new ModuleFederationPlugin({\n      name: 'header',\n      filename: 'remoteEntry.js',\n      exposes: {\n        './Header': './src/Header.jsx'\n      },\n      shared: {\n        react: { singleton: true },\n        'react-dom': { singleton: true }\n      }\n    })\n  ]\n};",
          "explanation": "Remoteåº”ç”¨é€šè¿‡exposesé…ç½®æ¥æš´éœ²å¯å…±äº«çš„æ¨¡å—"
        },
        {
          "step": 2,
          "action": "åˆ›å»ºHeaderç»„ä»¶",
          "code": "// header/src/Header.jsx\nimport React from 'react';\n\nconst Header = () => {\n  return (\n    <header style={{ background: '#1890ff', color: 'white', padding: '1rem' }}>\n      <h1>å¾®å‰ç«¯ Header ç»„ä»¶</h1>\n      <nav>\n        <a href=\"/\" style={{ color: 'white', marginRight: '1rem' }}>é¦–é¡µ</a>\n        <a href=\"/about\" style={{ color: 'white' }}>å…³äº</a>\n      </nav>\n    </header>\n  );\n};\n\nexport default Header;",
          "explanation": "è¿™æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„Reactç»„ä»¶ï¼Œå¯ä»¥è¢«å…¶ä»–åº”ç”¨ä½¿ç”¨"
        }
      ],
      "remoteAppFeatures": {
        "filename": "è¿œç¨‹å…¥å£æ–‡ä»¶åï¼Œé€šå¸¸æ˜¯remoteEntry.js",
        "exposes": "æš´éœ²çš„æ¨¡å—æ˜ å°„ï¼Œé”®æ˜¯åˆ«åï¼Œå€¼æ˜¯å®é™…æ–‡ä»¶è·¯å¾„",
        "ç‹¬ç«‹éƒ¨ç½²": "å¯ä»¥ç‹¬ç«‹æ„å»ºã€æµ‹è¯•ã€éƒ¨ç½²",
        "ç‰ˆæœ¬æ§åˆ¶": "å¯ä»¥ç‹¬ç«‹æ›´æ–°ç‰ˆæœ¬"
      },
      "expectedResult": "Headeråº”ç”¨åœ¨3001ç«¯å£è¿è¡Œï¼Œæš´éœ²Headerç»„ä»¶",
      "validation": {
        "type": "file-content",
        "file": "header/webpack.config.js",
        "contains": "exposes"
      }
    },
    {
      "id": "setup-sidebar-remote",
      "title": "ğŸ“‹ ä»»åŠ¡3ï¼šé…ç½®Sidebarè¿œç¨‹åº”ç”¨",
      "description": "åˆ›å»ºSidebarå¾®åº”ç”¨ï¼Œå±•ç¤ºå¦‚ä½•åŒæ—¶è¿è¡Œå¤šä¸ªè¿œç¨‹åº”ç”¨ã€‚",
      "specificSteps": [
        {
          "step": 1,
          "action": "é…ç½®Sidebaråº”ç”¨çš„æ¨¡å—è”é‚¦",
          "code": "const ModuleFederationPlugin = require('@module-federation/webpack');\n\nmodule.exports = {\n  mode: 'development',\n  entry: './src/index.js',\n  devServer: {\n    port: 3002\n  },\n  plugins: [\n    new ModuleFederationPlugin({\n      name: 'sidebar',\n      filename: 'remoteEntry.js',\n      exposes: {\n        './Sidebar': './src/Sidebar.jsx'\n      },\n      shared: {\n        react: { singleton: true },\n        'react-dom': { singleton: true }\n      }\n    })\n  ]\n};",
          "explanation": "æ¯ä¸ªè¿œç¨‹åº”ç”¨éƒ½æœ‰è‡ªå·±çš„ç«¯å£å’Œæš´éœ²çš„æ¨¡å—"
        }
      ],
      "expectedResult": "Sidebaråº”ç”¨åœ¨3002ç«¯å£è¿è¡Œï¼Œæš´éœ²Sidebarç»„ä»¶",
      "validation": {
        "type": "file-content",
        "file": "sidebar/webpack.config.js",
        "contains": "port: 3002"
      }
    },
    {
      "id": "integrate-remotes",
      "title": "ğŸ”— ä»»åŠ¡4ï¼šåœ¨ä¸»åº”ç”¨ä¸­é›†æˆè¿œç¨‹æ¨¡å—",
      "description": "åœ¨Shellåº”ç”¨ä¸­åŠ¨æ€å¯¼å…¥å’Œä½¿ç”¨è¿œç¨‹æ¨¡å—ï¼Œå®ç°å¾®å‰ç«¯çš„å®Œæ•´é›†æˆã€‚",
      "specificSteps": [
        {
          "step": 1,
          "action": "åœ¨Shellåº”ç”¨ä¸­ä½¿ç”¨è¿œç¨‹ç»„ä»¶",
          "code": "// shell/src/App.jsx\nimport React, { Suspense } from 'react';\n\n// åŠ¨æ€å¯¼å…¥è¿œç¨‹ç»„ä»¶\nconst Header = React.lazy(() => import('header/Header'));\nconst Sidebar = React.lazy(() => import('sidebar/Sidebar'));\n\nconst App = () => {\n  return (\n    <div>\n      <Suspense fallback={<div>Loading Header...</div>}>\n        <Header />\n      </Suspense>\n      \n      <div style={{ display: 'flex' }}>\n        <Suspense fallback={<div>Loading Sidebar...</div>}>\n          <Sidebar />\n        </Suspense>\n        \n        <main style={{ flex: 1, padding: '1rem' }}>\n          <h2>ä¸»åº”ç”¨å†…å®¹</h2>\n          <p>è¿™é‡Œæ˜¯ä¸»åº”ç”¨çš„å†…å®¹åŒºåŸŸ</p>\n        </main>\n      </div>\n    </div>\n  );\n};\n\nexport default App;",
          "explanation": "ä½¿ç”¨React.lazyå’ŒSuspenseæ¥å¼‚æ­¥åŠ è½½è¿œç¨‹ç»„ä»¶"
        }
      ],
      "integrationBenefits": {
        "ç‹¬ç«‹å¼€å‘": "å„å›¢é˜Ÿå¯ä»¥ç‹¬ç«‹å¼€å‘è‡ªå·±çš„æ¨¡å—",
        "ç‹¬ç«‹éƒ¨ç½²": "å¯ä»¥å•ç‹¬éƒ¨ç½²æŸä¸ªå¾®åº”ç”¨è€Œä¸å½±å“å…¶ä»–",
        "æŠ€æœ¯æ ˆçµæ´»": "ä¸åŒå¾®åº”ç”¨å¯ä»¥ä½¿ç”¨ä¸åŒç‰ˆæœ¬çš„ä¾èµ–",
        "å›¢é˜Ÿè‡ªæ²»": "æ¯ä¸ªå›¢é˜Ÿå¯¹è‡ªå·±çš„æ¨¡å—æœ‰å®Œå…¨æ§åˆ¶æƒ"
      },
      "expectedResult": "ä¸»åº”ç”¨æˆåŠŸé›†æˆå¹¶æ˜¾ç¤ºè¿œç¨‹çš„Headerå’ŒSidebarç»„ä»¶",
      "validation": {
        "type": "file-content",
        "file": "shell/src/App.jsx",
        "contains": "React.lazy"
      }
    }
  ],
  "progressiveHints": [
    {
      "attempt": 1,
      "hint": "ğŸ—ï¸ **ç¬¬ä¸€ä¸ªæç¤º**ï¼šæ¨¡å—è”é‚¦ä»ModuleFederationPluginå¼€å§‹ï¼š\n\n```javascript\nconst ModuleFederationPlugin = require('@module-federation/webpack');\n\n// Shellåº”ç”¨é…ç½®\nnew ModuleFederationPlugin({\n  name: 'shell',\n  remotes: {\n    header: 'header@http://localhost:3001/remoteEntry.js'\n  }\n})\n```"
    },
    {
      "attempt": 2,
      "hint": "ğŸ“¡ **ç¬¬äºŒä¸ªæç¤º**ï¼šRemoteåº”ç”¨éœ€è¦æš´éœ²æ¨¡å—ï¼š\n\n```javascript\n// Headeråº”ç”¨é…ç½®\nnew ModuleFederationPlugin({\n  name: 'header',\n  filename: 'remoteEntry.js',\n  exposes: {\n    './Header': './src/Header.jsx'\n  },\n  shared: {\n    react: { singleton: true }\n  }\n})\n```"
    },
    {
      "attempt": 3,
      "hint": "ğŸ¯ **å®Œæ•´çš„å¾®å‰ç«¯æ¶æ„**ï¼š\n\n```javascript\n// 1. Shellåº”ç”¨ (Host) - æ¶ˆè´¹è¿œç¨‹æ¨¡å—\nnew ModuleFederationPlugin({\n  name: 'shell',\n  remotes: {\n    header: 'header@http://localhost:3001/remoteEntry.js',\n    sidebar: 'sidebar@http://localhost:3002/remoteEntry.js'\n  },\n  shared: { react: { singleton: true } }\n})\n\n// 2. Headeråº”ç”¨ (Remote) - æš´éœ²Headerç»„ä»¶\nnew ModuleFederationPlugin({\n  name: 'header',\n  filename: 'remoteEntry.js',\n  exposes: { './Header': './src/Header.jsx' },\n  shared: { react: { singleton: true } }\n})\n\n// 3. åœ¨Shellä¸­ä½¿ç”¨\nconst Header = React.lazy(() => import('header/Header'));\n```"
    }
  ],
  "solution": {
    "shell/webpack.config.js": "const ModuleFederationPlugin = require('@module-federation/webpack');\nconst HtmlWebpackPlugin = require('html-webpack-plugin');\n\n// Shellåº”ç”¨é…ç½® - ä½œä¸ºHostæ¶ˆè´¹è¿œç¨‹æ¨¡å—\nmodule.exports = {\n  mode: 'development',\n  entry: './src/index.js',\n  devServer: {\n    port: 3000,\n    hot: true,\n    historyApiFallback: true\n  },\n  plugins: [\n    new ModuleFederationPlugin({\n      name: 'shell', // åº”ç”¨åç§°\n      remotes: {\n        // é…ç½®è¿œç¨‹åº”ç”¨\n        header: 'header@http://localhost:3001/remoteEntry.js',\n        sidebar: 'sidebar@http://localhost:3002/remoteEntry.js'\n      },\n      shared: {\n        // å…±äº«ä¾èµ–ï¼Œé¿å…é‡å¤åŠ è½½\n        react: { singleton: true, eager: true },\n        'react-dom': { singleton: true, eager: true }\n      }\n    }),\n    new HtmlWebpackPlugin({\n      template: './public/index.html'\n    })\n  ],\n  module: {\n    rules: [\n      {\n        test: /\\.jsx?$/,\n        exclude: /node_modules/,\n        use: {\n          loader: 'babel-loader',\n          options: {\n            presets: ['@babel/preset-react']\n          }\n        }\n      }\n    ]\n  }\n};",
    "header/webpack.config.js": "const ModuleFederationPlugin = require('@module-federation/webpack');\nconst HtmlWebpackPlugin = require('html-webpack-plugin');\n\n// Headeråº”ç”¨é…ç½® - ä½œä¸ºRemoteæš´éœ²ç»„ä»¶\nmodule.exports = {\n  mode: 'development',\n  entry: './src/index.js',\n  devServer: {\n    port: 3001,\n    hot: true\n  },\n  plugins: [\n    new ModuleFederationPlugin({\n      name: 'header', // åº”ç”¨åç§°\n      filename: 'remoteEntry.js', // è¿œç¨‹å…¥å£æ–‡ä»¶\n      exposes: {\n        // æš´éœ²çš„æ¨¡å—\n        './Header': './src/Header.jsx'\n      },\n      shared: {\n        // ä¸Shellåº”ç”¨å…±äº«ä¾èµ–\n        react: { singleton: true },\n        'react-dom': { singleton: true }\n      }\n    }),\n    new HtmlWebpackPlugin({\n      template: './public/index.html'\n    })\n  ],\n  module: {\n    rules: [\n      {\n        test: /\\.jsx?$/,\n        exclude: /node_modules/,\n        use: {\n          loader: 'babel-loader',\n          options: {\n            presets: ['@babel/preset-react']\n          }\n        }\n      }\n    ]\n  }\n};",
    "shell/src/App.jsx": "import React, { Suspense } from 'react';\n\n// åŠ¨æ€å¯¼å…¥è¿œç¨‹ç»„ä»¶\nconst Header = React.lazy(() => import('header/Header'));\nconst Sidebar = React.lazy(() => import('sidebar/Sidebar'));\n\nconst App = () => {\n  return (\n    <div className=\"app\">\n      {/* è¿œç¨‹Headerç»„ä»¶ */}\n      <Suspense fallback={<div>Loading Header...</div>}>\n        <Header />\n      </Suspense>\n      \n      <div style={{ display: 'flex', minHeight: 'calc(100vh - 80px)' }}>\n        {/* è¿œç¨‹Sidebarç»„ä»¶ */}\n        <Suspense fallback={<div>Loading Sidebar...</div>}>\n          <Sidebar />\n        </Suspense>\n        \n        {/* ä¸»åº”ç”¨å†…å®¹ */}\n        <main style={{ flex: 1, padding: '2rem' }}>\n          <h2>ğŸ  ä¸»åº”ç”¨å†…å®¹åŒºåŸŸ</h2>\n          <p>è¿™é‡Œæ˜¯Shellåº”ç”¨çš„ä¸»è¦å†…å®¹ã€‚</p>\n          <p>Headerå’ŒSidebarç»„ä»¶æ¥è‡ªä¸åŒçš„å¾®åº”ç”¨ï¼Œå®ƒä»¬å¯ä»¥ï¼š</p>\n          <ul>\n            <li>âœ… ç‹¬ç«‹å¼€å‘å’Œéƒ¨ç½²</li>\n            <li>âœ… ä½¿ç”¨ä¸åŒçš„æŠ€æœ¯æ ˆç‰ˆæœ¬</li>\n            <li>âœ… ç”±ä¸åŒå›¢é˜Ÿç»´æŠ¤</li>\n            <li>âœ… åœ¨è¿è¡Œæ—¶åŠ¨æ€åŠ è½½</li>\n          </ul>\n        </main>\n      </div>\n    </div>\n  );\n};\n\nexport default App;"
  },
  "resources": [
    {
      "title": "Module Federation å®˜æ–¹æ–‡æ¡£",
      "url": "https://webpack.js.org/concepts/module-federation/"
    },
    {
      "title": "å¾®å‰ç«¯å®è·µæŒ‡å—",
      "url": "https://micro-frontends.org/"
    }
  ]
}