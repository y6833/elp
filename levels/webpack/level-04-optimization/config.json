{
  "id": "webpack-code-splitting",
  "title": "âœ‚ï¸ Webpack ä»£ç åˆ†å‰² - è®©åº”ç”¨åŠ è½½æ›´å¿«",
  "description": "æƒ³è±¡ä¸€ä¸‹ï¼Œç”¨æˆ·è®¿é—®ä½ çš„ç½‘ç«™æ—¶ä¸éœ€è¦ä¸‹è½½æ•´ä¸ªåº”ç”¨çš„ä»£ç ï¼Œè€Œæ˜¯æŒ‰éœ€åŠ è½½ã€‚ä»£ç åˆ†å‰²å°±æ˜¯è¿™æ ·çš„é­”æ³•ï¼å®ƒå¯ä»¥å°†å¤§çš„bundleæ‹†åˆ†æˆå°å—ï¼Œå®ç°æ‡’åŠ è½½ï¼Œå¤§å¹…æå‡é¦–å±åŠ è½½é€Ÿåº¦ã€‚",
  "difficulty": "é«˜çº§",
  "estimatedTime": "30åˆ†é’Ÿ",
  "category": "webpack",
  "scenario": "ä½ çš„å•é¡µåº”ç”¨è¶Šæ¥è¶Šå¤§ï¼Œç”¨æˆ·åé¦ˆé¦–æ¬¡åŠ è½½å¾ˆæ…¢ã€‚ä½ éœ€è¦ä½¿ç”¨ä»£ç åˆ†å‰²æŠ€æœ¯ï¼Œå°†ç¬¬ä¸‰æ–¹åº“ã€å…¬å…±ä»£ç å’Œé¡µé¢ä»£ç åˆ†åˆ«æ‰“åŒ…ï¼Œå®ç°æŒ‰éœ€åŠ è½½ã€‚",
  "learningObjectives": [
    "âœ‚ï¸ ç†è§£ä»£ç åˆ†å‰²çš„åŸç†å’Œä»·å€¼",
    "ğŸ“¦ é…ç½®splitChunksæå–å…¬å…±ä»£ç å’Œç¬¬ä¸‰æ–¹åº“",
    "ğŸ”„ è®¾ç½®runtimeChunkåˆ†ç¦»è¿è¡Œæ—¶ä»£ç ",
    "ğŸš€ å®ç°åŠ¨æ€å¯¼å…¥å’Œæ‡’åŠ è½½"
  ],
  "tasks": [
    {
      "id": "setup-split-chunks",
      "title": "ğŸ“¦ ä»»åŠ¡1ï¼šé…ç½®ä»£ç åˆ†å‰²ç­–ç•¥",
      "description": "é…ç½®splitChunksæ¥è‡ªåŠ¨åˆ†ç¦»ç¬¬ä¸‰æ–¹åº“å’Œå…¬å…±ä»£ç ï¼Œå‡å°‘é‡å¤æ‰“åŒ…ã€‚",
      "specificSteps": [
        {
          "step": 1,
          "action": "åœ¨webpack.config.jsä¸­æ·»åŠ optimizationé…ç½®",
          "code": "optimization: {\n  splitChunks: {\n    chunks: 'all',\n    cacheGroups: {\n      vendor: {\n        test: /[\\\\/]node_modules[\\\\/]/,\n        name: 'vendors',\n        chunks: 'all'\n      }\n    }\n  }\n},",
          "explanation": "å°†ç¬¬ä¸‰æ–¹åº“åˆ†ç¦»åˆ°vendors.jsæ–‡ä»¶ä¸­"
        }
      ],
      "splitChunksOptions": {
        "chunks: 'all'": "åˆ†å‰²æ‰€æœ‰ç±»å‹çš„chunkï¼ˆåŒæ­¥å’Œå¼‚æ­¥ï¼‰",
        "cacheGroups.vendor": "å°†node_modulesä¸­çš„ä»£ç åˆ†ç¦»åˆ°vendorsæ–‡ä»¶",
        "test": "æ­£åˆ™è¡¨è¾¾å¼ï¼ŒåŒ¹é…è¦åˆ†ç¦»çš„æ¨¡å—è·¯å¾„",
        "name": "åˆ†ç¦»åçš„chunkåç§°"
      },
      "expectedResult": "æ„å»ºåä¼šç”Ÿæˆvendors.jsæ–‡ä»¶ï¼ŒåŒ…å«æ‰€æœ‰ç¬¬ä¸‰æ–¹åº“ä»£ç ",
      "validation": {
        "type": "file-content",
        "file": "webpack.config.js",
        "contains": "splitChunks"
      }
    },
    {
      "id": "setup-runtime-chunk",
      "title": "ğŸ”„ ä»»åŠ¡2ï¼šåˆ†ç¦»è¿è¡Œæ—¶ä»£ç ",
      "description": "å°†Webpackçš„è¿è¡Œæ—¶ä»£ç åˆ†ç¦»åˆ°å•ç‹¬æ–‡ä»¶ï¼Œæé«˜ç¼“å­˜æ•ˆç‡ã€‚",
      "specificSteps": [
        {
          "step": 1,
          "action": "åœ¨optimizationä¸­æ·»åŠ runtimeChunké…ç½®",
          "code": "runtimeChunk: 'single',",
          "explanation": "å°†è¿è¡Œæ—¶ä»£ç åˆ†ç¦»åˆ°runtime.jsæ–‡ä»¶"
        }
      ],
      "runtimeChunkBenefits": {
        "ç¼“å­˜ä¼˜åŒ–": "è¿è¡Œæ—¶ä»£ç å˜åŒ–é¢‘ç‡ä½ï¼Œå¯ä»¥é•¿æœŸç¼“å­˜",
        "å¹¶è¡ŒåŠ è½½": "è¿è¡Œæ—¶å’Œä¸šåŠ¡ä»£ç å¯ä»¥å¹¶è¡Œä¸‹è½½",
        "ç‰ˆæœ¬æ§åˆ¶": "ä¸šåŠ¡ä»£ç æ›´æ–°æ—¶ï¼Œè¿è¡Œæ—¶ä»£ç ä¸éœ€è¦é‡æ–°ä¸‹è½½"
      },
      "expectedResult": "æ„å»ºåä¼šç”Ÿæˆruntime.jsæ–‡ä»¶ï¼ŒåŒ…å«Webpackè¿è¡Œæ—¶ä»£ç ",
      "validation": {
        "type": "file-content",
        "file": "webpack.config.js",
        "contains": "runtimeChunk"
      }
    },
    {
      "id": "implement-dynamic-import",
      "title": "ğŸš€ ä»»åŠ¡3ï¼šå®ç°åŠ¨æ€å¯¼å…¥",
      "description": "åœ¨ä»£ç ä¸­ä½¿ç”¨åŠ¨æ€å¯¼å…¥è¯­æ³•ï¼Œå®ç°ç»„ä»¶çš„æ‡’åŠ è½½ã€‚",
      "specificSteps": [
        {
          "step": 1,
          "action": "åœ¨src/index.jsä¸­æ·»åŠ åŠ¨æ€å¯¼å…¥ç¤ºä¾‹",
          "code": "// åŠ¨æ€å¯¼å…¥ç¤ºä¾‹\nconst loadComponent = async () => {\n  const { default: LazyComponent } = await import('./components/LazyComponent');\n  return LazyComponent;\n};\n\n// æŒ‰éœ€åŠ è½½\ndocument.getElementById('load-btn').addEventListener('click', async () => {\n  const Component = await loadComponent();\n  Component.render();\n});",
          "explanation": "ä½¿ç”¨import()å‡½æ•°å®ç°åŠ¨æ€å¯¼å…¥"
        }
      ],
      "dynamicImportBenefits": {
        "æŒ‰éœ€åŠ è½½": "åªæœ‰ç”¨æˆ·éœ€è¦æ—¶æ‰ä¸‹è½½å¯¹åº”ä»£ç ",
        "é¦–å±ä¼˜åŒ–": "å‡å°‘åˆå§‹bundleå¤§å°ï¼Œæå‡é¦–å±åŠ è½½é€Ÿåº¦",
        "ç”¨æˆ·ä½“éªŒ": "æ ¸å¿ƒåŠŸèƒ½å¿«é€Ÿå¯ç”¨ï¼Œæ¬¡è¦åŠŸèƒ½æŒ‰éœ€åŠ è½½"
      },
      "expectedResult": "ç‚¹å‡»æŒ‰é’®æ—¶æ‰ä¼šåŠ è½½LazyComponentç›¸å…³ä»£ç ",
      "validation": {
        "type": "file-content",
        "file": "src/index.js",
        "contains": "import("
      }
    }
  ],
  "progressiveHints": [
    {
      "attempt": 1,
      "hint": "âœ‚ï¸ **ç¬¬ä¸€ä¸ªæç¤º**ï¼šä»£ç åˆ†å‰²ä»optimizationé…ç½®å¼€å§‹ï¼š\n\n```javascript\noptimization: {\n  splitChunks: {\n    chunks: 'all'\n  }\n}\n```\n\nè¿™ä¼šè‡ªåŠ¨åˆ†ç¦»å…¬å…±ä»£ç ã€‚"
    },
    {
      "attempt": 2,
      "hint": "ğŸ“¦ **ç¬¬äºŒä¸ªæç¤º**ï¼šæ·»åŠ æ›´è¯¦ç»†çš„åˆ†å‰²ç­–ç•¥ï¼š\n\n```javascript\noptimization: {\n  splitChunks: {\n    chunks: 'all',\n    cacheGroups: {\n      vendor: {\n        test: /[\\\\/]node_modules[\\\\/]/,\n        name: 'vendors',\n        chunks: 'all'\n      }\n    }\n  },\n  runtimeChunk: 'single'\n}\n```"
    },
    {
      "attempt": 3,
      "hint": "ğŸ¯ **å®Œæ•´é…ç½®æ¨¡æ¿**ï¼š\n\n```javascript\nconst path = require('path');\n\nmodule.exports = {\n  entry: './src/index.js',\n  output: {\n    path: path.resolve(__dirname, 'dist'),\n    filename: '[name].[contenthash].js'\n  },\n  mode: 'production',\n  \n  optimization: {\n    // ä»£ç åˆ†å‰²é…ç½®\n    splitChunks: {\n      chunks: 'all',\n      cacheGroups: {\n        // ç¬¬ä¸‰æ–¹åº“åˆ†ç¦»\n        vendor: {\n          test: /[\\\\/]node_modules[\\\\/]/,\n          name: 'vendors',\n          chunks: 'all'\n        },\n        // å…¬å…±ä»£ç åˆ†ç¦»\n        common: {\n          name: 'common',\n          minChunks: 2,\n          chunks: 'all',\n          enforce: true\n        }\n      }\n    },\n    // è¿è¡Œæ—¶ä»£ç åˆ†ç¦»\n    runtimeChunk: 'single'\n  }\n};\n```"
    }
  ],
  "solution": {
    "webpack.config.js": "const path = require('path');\n\nmodule.exports = {\n  entry: './src/index.js',\n  output: {\n    path: path.resolve(__dirname, 'dist'),\n    filename: '[name].[contenthash].js', // ä½¿ç”¨contenthashä¼˜åŒ–ç¼“å­˜\n    clean: true\n  },\n  mode: 'production',\n  \n  // ä¼˜åŒ–é…ç½®\n  optimization: {\n    // ä»£ç åˆ†å‰²é…ç½®\n    splitChunks: {\n      chunks: 'all', // åˆ†å‰²æ‰€æœ‰ç±»å‹çš„chunk\n      cacheGroups: {\n        // ç¬¬ä¸‰æ–¹åº“åˆ†ç¦»åˆ°vendorsæ–‡ä»¶\n        vendor: {\n          test: /[\\\\/]node_modules[\\\\/]/, // åŒ¹é…node_modulesä¸­çš„æ¨¡å—\n          name: 'vendors',\n          chunks: 'all'\n        },\n        // å…¬å…±ä»£ç åˆ†ç¦»\n        common: {\n          name: 'common',\n          minChunks: 2, // è‡³å°‘è¢«2ä¸ªchunkå¼•ç”¨æ‰åˆ†ç¦»\n          chunks: 'all',\n          enforce: true\n        }\n      }\n    },\n    // è¿è¡Œæ—¶ä»£ç åˆ†ç¦»åˆ°å•ç‹¬æ–‡ä»¶\n    runtimeChunk: 'single'\n  }\n};",
    "src/index.js": "// ä¸»å…¥å£æ–‡ä»¶\nimport './styles.css';\n\nconsole.log('åº”ç”¨å¯åŠ¨');\n\n// åŠ¨æ€å¯¼å…¥ç¤ºä¾‹ - å®ç°æ‡’åŠ è½½\nconst loadLazyComponent = async () => {\n  try {\n    const { default: LazyComponent } = await import('./components/LazyComponent');\n    return LazyComponent;\n  } catch (error) {\n    console.error('åŠ è½½ç»„ä»¶å¤±è´¥:', error);\n  }\n};\n\n// æŒ‰éœ€åŠ è½½ç»„ä»¶\nconst loadBtn = document.getElementById('load-btn');\nif (loadBtn) {\n  loadBtn.addEventListener('click', async () => {\n    const LazyComponent = await loadLazyComponent();\n    if (LazyComponent) {\n      LazyComponent.render();\n    }\n  });\n}"
  },
  "validation": {
    "required": [
      {
        "key": "optimization:",
        "message": "è¯·æ·»åŠ  optimization é…ç½®",
        "hints": ["optimization ç”¨äºé…ç½® webpack çš„ä¼˜åŒ–é€‰é¡¹"]
      },
      {
        "key": "splitChunks:",
        "message": "è¯·é…ç½® splitChunks è¿›è¡Œä»£ç åˆ†å‰²",
        "hints": ["splitChunks å¯ä»¥å°†ä»£ç åˆ†å‰²æˆå¤šä¸ª chunk"]
      },
      {
        "key": "runtimeChunk:",
        "message": "è¯·é…ç½® runtimeChunk åˆ†ç¦»è¿è¡Œæ—¶ä»£ç ",
        "hints": ["runtimeChunk: 'single' å¯ä»¥å°†è¿è¡Œæ—¶ä»£ç åˆ†ç¦»åˆ°å•ç‹¬æ–‡ä»¶"]
      },
      {
        "key": "chunks: 'all'",
        "message": "è¯·è®¾ç½® chunks ä¸º 'all' ä»¥åˆ†å‰²æ‰€æœ‰ç±»å‹çš„ chunk",
        "hints": ["chunks: 'all' ä¼šåˆ†å‰²åŒæ­¥å’Œå¼‚æ­¥å¯¼å…¥çš„æ¨¡å—"]
      }
    ]
  }
}