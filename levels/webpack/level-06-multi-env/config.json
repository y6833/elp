{
  "id": "webpack-multi-env",
  "title": "ğŸŒ Webpack å¤šç¯å¢ƒé…ç½® - å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒç®¡ç†",
  "description": "çœŸå®é¡¹ç›®ä¸­ï¼Œå¼€å‘ç¯å¢ƒéœ€è¦å¿«é€Ÿæ„å»ºå’Œçƒ­é‡è½½ï¼Œç”Ÿäº§ç¯å¢ƒéœ€è¦ä»£ç å‹ç¼©å’Œä¼˜åŒ–ã€‚è¿™ä¸€å…³å°†æ•™ä½ å¦‚ä½•ä¼˜é›…åœ°ç®¡ç†å¤šç¯å¢ƒé…ç½®ï¼Œä½¿ç”¨webpack-mergeåˆå¹¶é…ç½®ï¼Œé€šè¿‡ç¯å¢ƒå˜é‡æ§åˆ¶ä¸åŒçš„æ„å»ºç­–ç•¥ã€‚",
  "difficulty": "ä¸­çº§",
  "estimatedTime": "35åˆ†é’Ÿ",
  "category": "webpack",
  "scenario": "ä½ çš„é¡¹ç›®éœ€è¦éƒ¨ç½²åˆ°å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ä¸‰ä¸ªç¯å¢ƒï¼Œæ¯ä¸ªç¯å¢ƒçš„éœ€æ±‚ä¸åŒï¼šå¼€å‘ç¯å¢ƒè¦å¿«é€Ÿæ„å»ºï¼Œç”Ÿäº§ç¯å¢ƒè¦æè‡´ä¼˜åŒ–ï¼Œæµ‹è¯•ç¯å¢ƒè¦ä¾¿äºè°ƒè¯•ã€‚ä½ éœ€è¦è®¾è®¡ä¸€å¥—çµæ´»çš„å¤šç¯å¢ƒé…ç½®æ–¹æ¡ˆã€‚",
  "learningObjectives": [
    "ğŸ”§ ç†è§£ä¸åŒç¯å¢ƒçš„æ„å»ºéœ€æ±‚å·®å¼‚",
    "ğŸ”€ ä½¿ç”¨webpack-mergeä¼˜é›…åœ°åˆå¹¶é…ç½®",
    "ğŸŒ é€šè¿‡ç¯å¢ƒå˜é‡æ§åˆ¶æ„å»ºè¡Œä¸º",
    "âš¡ ä¸ºä¸åŒç¯å¢ƒé…ç½®æœ€é€‚åˆçš„ä¼˜åŒ–ç­–ç•¥"
  ],
  "tasks": [
    {
      "id": "setup-common-config",
      "title": "ğŸ”§ ä»»åŠ¡1ï¼šåˆ›å»ºé€šç”¨é…ç½®æ–‡ä»¶",
      "description": "åˆ›å»ºwebpack.common.jsæ–‡ä»¶ï¼ŒåŒ…å«æ‰€æœ‰ç¯å¢ƒå…±ç”¨çš„é…ç½®é¡¹ï¼Œå¦‚å…¥å£ã€è¾“å‡ºã€åŸºç¡€loaderç­‰ã€‚",
      "specificSteps": [
        {
          "step": 1,
          "action": "åˆ›å»ºwebpack.common.jsæ–‡ä»¶",
          "code": "const path = require('path');\nconst HtmlWebpackPlugin = require('html-webpack-plugin');\n\nmodule.exports = {\n  entry: './src/index.js',\n  output: {\n    path: path.resolve(__dirname, 'dist'),\n    clean: true\n  },\n  plugins: [\n    new HtmlWebpackPlugin({\n      template: './src/index.html'\n    })\n  ],\n  module: {\n    rules: [\n      {\n        test: /\\.css$/i,\n        use: ['style-loader', 'css-loader']\n      }\n    ]\n  }\n};",
          "explanation": "é€šç”¨é…ç½®åŒ…å«æ‰€æœ‰ç¯å¢ƒéƒ½éœ€è¦çš„åŸºç¡€è®¾ç½®"
        }
      ],
      "expectedResult": "åˆ›å»ºäº†åŒ…å«åŸºç¡€é…ç½®çš„é€šç”¨æ–‡ä»¶",
      "validation": {
        "type": "file-exists",
        "files": ["webpack.common.js"]
      }
    },
    {
      "id": "setup-dev-config",
      "title": "ğŸš€ ä»»åŠ¡2ï¼šé…ç½®å¼€å‘ç¯å¢ƒ",
      "description": "åˆ›å»ºwebpack.dev.jsï¼Œé…ç½®å¼€å‘ç¯å¢ƒç‰¹æœ‰çš„é€‰é¡¹ï¼šå¿«é€Ÿæ„å»ºã€çƒ­é‡è½½ã€è¯¦ç»†çš„source mapã€‚",
      "specificSteps": [
        {
          "step": 1,
          "action": "åˆ›å»ºwebpack.dev.jsæ–‡ä»¶",
          "code": "const { merge } = require('webpack-merge');\nconst common = require('./webpack.common.js');\nconst webpack = require('webpack');\n\nmodule.exports = merge(common, {\n  mode: 'development',\n  devtool: 'eval-source-map',\n  output: {\n    filename: '[name].js'\n  },\n  devServer: {\n    hot: true,\n    port: 3000,\n    open: true\n  },\n  plugins: [\n    new webpack.DefinePlugin({\n      'process.env.NODE_ENV': JSON.stringify('development'),\n      'process.env.API_URL': JSON.stringify('http://localhost:8080/api')\n    })\n  ]\n});",
          "explanation": "å¼€å‘ç¯å¢ƒä¼˜å…ˆè€ƒè™‘æ„å»ºé€Ÿåº¦å’Œè°ƒè¯•ä½“éªŒ"
        }
      ],
      "devConfigFeatures": {
        "eval-source-map": "æœ€å¿«çš„source mapï¼Œé€‚åˆå¼€å‘è°ƒè¯•",
        "hot: true": "å¯ç”¨çƒ­æ¨¡å—æ›¿æ¢ï¼Œæå‡å¼€å‘ä½“éªŒ",
        "DefinePlugin": "æ³¨å…¥ç¯å¢ƒå˜é‡ï¼ŒåŒºåˆ†ä¸åŒç¯å¢ƒ"
      },
      "expectedResult": "å¼€å‘ç¯å¢ƒé…ç½®æ–‡ä»¶ï¼Œæ”¯æŒçƒ­é‡è½½å’Œå¿«é€Ÿæ„å»º",
      "validation": {
        "type": "file-content",
        "file": "webpack.dev.js",
        "contains": "webpack-merge"
      }
    },
    {
      "id": "setup-prod-config",
      "title": "ğŸ­ ä»»åŠ¡3ï¼šé…ç½®ç”Ÿäº§ç¯å¢ƒ",
      "description": "åˆ›å»ºwebpack.prod.jsï¼Œé…ç½®ç”Ÿäº§ç¯å¢ƒçš„ä¼˜åŒ–é€‰é¡¹ï¼šä»£ç å‹ç¼©ã€æ–‡ä»¶åhashã€æ€§èƒ½ä¼˜åŒ–ã€‚",
      "specificSteps": [
        {
          "step": 1,
          "action": "åˆ›å»ºwebpack.prod.jsæ–‡ä»¶",
          "code": "const { merge } = require('webpack-merge');\nconst common = require('./webpack.common.js');\nconst webpack = require('webpack');\n\nmodule.exports = merge(common, {\n  mode: 'production',\n  devtool: 'source-map',\n  output: {\n    filename: '[name].[contenthash].js'\n  },\n  optimization: {\n    splitChunks: {\n      chunks: 'all'\n    },\n    runtimeChunk: 'single'\n  },\n  plugins: [\n    new webpack.DefinePlugin({\n      'process.env.NODE_ENV': JSON.stringify('production'),\n      'process.env.API_URL': JSON.stringify('https://api.example.com')\n    })\n  ]\n});",
          "explanation": "ç”Ÿäº§ç¯å¢ƒä¼˜å…ˆè€ƒè™‘æ€§èƒ½ä¼˜åŒ–å’Œæ–‡ä»¶å¤§å°"
        }
      ],
      "prodConfigFeatures": {
        "contenthash": "æ–‡ä»¶å†…å®¹å˜åŒ–æ—¶æ‰æ›´æ–°hashï¼Œä¼˜åŒ–ç¼“å­˜",
        "splitChunks": "ä»£ç åˆ†å‰²ï¼Œæå‡åŠ è½½æ€§èƒ½",
        "mode: 'production'": "è‡ªåŠ¨å¯ç”¨å‹ç¼©å’Œä¼˜åŒ–"
      },
      "expectedResult": "ç”Ÿäº§ç¯å¢ƒé…ç½®æ–‡ä»¶ï¼ŒåŒ…å«å®Œæ•´çš„ä¼˜åŒ–ç­–ç•¥",
      "validation": {
        "type": "file-content",
        "file": "webpack.prod.js",
        "contains": "contenthash"
      }
    },
    {
      "id": "setup-package-scripts",
      "title": "ğŸ“¦ ä»»åŠ¡4ï¼šé…ç½®æ„å»ºè„šæœ¬",
      "description": "åœ¨package.jsonä¸­æ·»åŠ ä¸åŒç¯å¢ƒçš„æ„å»ºè„šæœ¬ï¼Œæ–¹ä¾¿å›¢é˜Ÿä½¿ç”¨ã€‚",
      "specificSteps": [
        {
          "step": 1,
          "action": "æ›´æ–°package.jsonçš„scriptséƒ¨åˆ†",
          "code": "{\n  \"scripts\": {\n    \"dev\": \"webpack serve --config webpack.dev.js\",\n    \"build:dev\": \"webpack --config webpack.dev.js\",\n    \"build:prod\": \"webpack --config webpack.prod.js\",\n    \"build\": \"npm run build:prod\"\n  }\n}",
          "explanation": "æä¾›æ¸…æ™°çš„å‘½ä»¤æ¥æ„å»ºä¸åŒç¯å¢ƒ"
        }
      ],
      "scriptExplanation": {
        "dev": "å¯åŠ¨å¼€å‘æœåŠ¡å™¨",
        "build:dev": "æ„å»ºå¼€å‘ç‰ˆæœ¬",
        "build:prod": "æ„å»ºç”Ÿäº§ç‰ˆæœ¬",
        "build": "é»˜è®¤æ„å»ºç”Ÿäº§ç‰ˆæœ¬"
      },
      "expectedResult": "å›¢é˜Ÿå¯ä»¥ä½¿ç”¨npm run devã€npm run buildç­‰å‘½ä»¤",
      "validation": {
        "type": "file-content",
        "file": "package.json",
        "contains": "webpack.dev.js"
      }
    }
  ],
  "progressiveHints": [
    {
      "attempt": 1,
      "hint": "ğŸ”§ **ç¬¬ä¸€ä¸ªæç¤º**ï¼šå¤šç¯å¢ƒé…ç½®ä»åˆ†ç¦»å¼€å§‹ã€‚åˆ›å»ºä¸‰ä¸ªæ–‡ä»¶ï¼š\n\n```javascript\n// webpack.common.js - é€šç”¨é…ç½®\nmodule.exports = {\n  entry: './src/index.js',\n  // å…±åŒçš„é…ç½®...\n};\n```"
    },
    {
      "attempt": 2,
      "hint": "ğŸ”€ **ç¬¬äºŒä¸ªæç¤º**ï¼šä½¿ç”¨webpack-mergeåˆå¹¶é…ç½®ï¼š\n\n```javascript\n// webpack.dev.js\nconst { merge } = require('webpack-merge');\nconst common = require('./webpack.common.js');\n\nmodule.exports = merge(common, {\n  mode: 'development',\n  devtool: 'eval-source-map'\n});\n```"
    },
    {
      "attempt": 3,
      "hint": "ğŸ¯ **å®Œæ•´é…ç½®ç¤ºä¾‹**ï¼š\n\n```javascript\n// webpack.common.js\nconst path = require('path');\nconst HtmlWebpackPlugin = require('html-webpack-plugin');\n\nmodule.exports = {\n  entry: './src/index.js',\n  output: {\n    path: path.resolve(__dirname, 'dist'),\n    clean: true\n  },\n  plugins: [\n    new HtmlWebpackPlugin({ template: './src/index.html' })\n  ]\n};\n\n// webpack.dev.js\nconst { merge } = require('webpack-merge');\nconst common = require('./webpack.common.js');\n\nmodule.exports = merge(common, {\n  mode: 'development',\n  devtool: 'eval-source-map',\n  devServer: { hot: true, port: 3000 }\n});\n```"
    }
  ],
  "solution": {
    "webpack.common.js": "const path = require('path');\nconst HtmlWebpackPlugin = require('html-webpack-plugin');\n\n// é€šç”¨é…ç½® - æ‰€æœ‰ç¯å¢ƒå…±äº«\nmodule.exports = {\n  entry: './src/index.js',\n  output: {\n    path: path.resolve(__dirname, 'dist'),\n    clean: true // æ„å»ºå‰æ¸…ç†è¾“å‡ºç›®å½•\n  },\n  plugins: [\n    new HtmlWebpackPlugin({\n      template: './src/index.html',\n      title: 'å¤šç¯å¢ƒé…ç½®ç¤ºä¾‹'\n    })\n  ],\n  module: {\n    rules: [\n      {\n        test: /\\.css$/i,\n        use: ['style-loader', 'css-loader']\n      },\n      {\n        test: /\\.(png|jpg|jpeg|gif|svg)$/i,\n        type: 'asset/resource'\n      }\n    ]\n  }\n};",
    "webpack.dev.js": "const { merge } = require('webpack-merge');\nconst common = require('./webpack.common.js');\nconst webpack = require('webpack');\n\n// å¼€å‘ç¯å¢ƒé…ç½® - ä¼˜å…ˆè€ƒè™‘æ„å»ºé€Ÿåº¦å’Œè°ƒè¯•ä½“éªŒ\nmodule.exports = merge(common, {\n  mode: 'development',\n  devtool: 'eval-source-map', // æœ€å¿«çš„source map\n  output: {\n    filename: '[name].js' // å¼€å‘ç¯å¢ƒä¸éœ€è¦hash\n  },\n  devServer: {\n    hot: true, // çƒ­æ¨¡å—æ›¿æ¢\n    port: 3000,\n    open: true,\n    historyApiFallback: true\n  },\n  plugins: [\n    new webpack.DefinePlugin({\n      'process.env.NODE_ENV': JSON.stringify('development'),\n      'process.env.API_URL': JSON.stringify('http://localhost:8080/api')\n    })\n  ]\n});",
    "webpack.prod.js": "const { merge } = require('webpack-merge');\nconst common = require('./webpack.common.js');\nconst webpack = require('webpack');\n\n// ç”Ÿäº§ç¯å¢ƒé…ç½® - ä¼˜å…ˆè€ƒè™‘æ€§èƒ½ä¼˜åŒ–å’Œæ–‡ä»¶å¤§å°\nmodule.exports = merge(common, {\n  mode: 'production', // è‡ªåŠ¨å¯ç”¨å‹ç¼©å’Œä¼˜åŒ–\n  devtool: 'source-map', // ç”Ÿäº§ç¯å¢ƒç”¨é«˜è´¨é‡source map\n  output: {\n    filename: '[name].[contenthash].js' // å†…å®¹hashä¼˜åŒ–ç¼“å­˜\n  },\n  optimization: {\n    splitChunks: {\n      chunks: 'all',\n      cacheGroups: {\n        vendor: {\n          test: /[\\\\/]node_modules[\\\\/]/,\n          name: 'vendors',\n          chunks: 'all'\n        }\n      }\n    },\n    runtimeChunk: 'single' // è¿è¡Œæ—¶ä»£ç åˆ†ç¦»\n  },\n  plugins: [\n    new webpack.DefinePlugin({\n      'process.env.NODE_ENV': JSON.stringify('production'),\n      'process.env.API_URL': JSON.stringify('https://api.example.com')\n    })\n  ],\n  performance: {\n    hints: 'warning',\n    maxEntrypointSize: 250000,\n    maxAssetSize: 250000\n  }\n});"
  },
  "resources": [
    {
      "title": "Webpack ç¯å¢ƒé…ç½®",
      "url": "https://webpack.js.org/guides/production/"
    },
    {
      "title": "webpack-merge æ–‡æ¡£",
      "url": "https://github.com/survivejs/webpack-merge"
    }
  ]
}